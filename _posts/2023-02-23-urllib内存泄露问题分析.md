---
layout: post
title: python urllib内存泄露问题分析
category: python
catalog: true
published: true
tags:
  - python
time: '2023.02.23 12:07:00'
---

# 问题背景
在python2/3中调用urllib模块会有循环引用没被释放，触发代码如下所示：
```python
if __name__ == '__main__':
  import urllib2
  a = urllib2.urlopen('http://www.google.com')
  del a

  # check memory on memory leaks
  import gc
  # the unreachable object will be freed if this flag not set
  gc.set_debug(gc.DEBUG_SAVEALL)
  gc.collect()
  print("the unreachable object len: %s" % len(gc.garbage))

```

# 参考文献
- [urllib2's urlopen() method causes a memory leak](https://github.com/python/cpython/issues/42012)