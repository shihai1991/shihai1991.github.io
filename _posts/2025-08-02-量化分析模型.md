---
layout: post
title: 量化分析模型 
category: 量化
catalog: true
published: false
tags:
  - 量化
time: '2025.08.02 17:07:00'
---

---
## 一、基础成交量分析算法

介绍了常见的量化算法对成交量进行分析，包括：

- **成交量均线**：计算n日成交量均值，判断当前成交量是否异常。
- **成交量激增检测**：如当前成交量超过历史均值阈值，判定为激增。
- **OBV（能量潮指标）**：结合成交量与价格变动，分析资金流向。
- **VWAP（成交量加权平均价）**：识别主力资金真实交易区间。
- **突破量算法**：量突破结合价变化，判断是否为有效突破。
- **量价关系分析**：量增价涨、量增价跌、量缩价稳等资金行为推断。
- **成交量结构分析**：分时或盘口成交量分析，识别主动买卖资金行为。

---

## 二、进阶量价关系及市场心理分析算法

针对仅分析成交量简单性，推荐了更高级的量价关系分析方法：

1. **量价背离算法**  
   价格创新高/低但成交量未同步，主力行为减弱，警示趋势反转。
   2. **OBV+趋势品种筛选**
   3. **VPT（量价趋势）**  
      量对价格变动的拉动作用，量价同步强势，背离警惕反转。
      4. **VWAP分时量价心理算法**
      5. **筹码分布与换手率分析**
      6. **量价心理模型（VSA）**  
         结合K线形态与成交量，分析市场参与者心理。
         7. **多周期量价共振**  
            不同周期的量价协同确认主力行为。

            ---

## 三、纯成交量与成交均价背离检测量化模型

### 数据输入格式

| 股票代码 | 交易日期  | 成交量     | 成交均价 |
|----------|-----------|------------|----------|
| 600000   | 2025-07-31| 123456789  | 12.34    |

### 模型流程

1. 按股票代码分组，日期排序
2. 周度、月度成交量与均价统计
3. 计算短期（5日）、中期（20日）成交量与均价均线
4. 检测量价背离（如成交量激增但均价无明显变化）
5. 输出量价背离信号及周期统计

### Python代码范例

```python
import pandas as pd

def preprocess(df):
    df['交易日期'] = pd.to_datetime(df['交易日期'])
        df = df.sort_values(['股票代码', '交易日期'])
            return df

            def resample_period(df, period='W'):
                return df.groupby('股票代码').resample(period, on='交易日期').agg({
                            '成交量': 'sum',
                                    '成交均价': 'mean'
                                        }).reset_index()

                                        def calc_moving_average(df, window=5):
                                            df[f'成交量均线_{window}日'] = df.groupby('股票代码')['成交量'].transform(lambda x: x.rolling(window).mean())
                                                df[f'成交均价均线_{window}日'] = df.groupby('股票代码')['成交均价'].transform(lambda x: x.rolling(window).mean())
                                                    return df

                                                    def detect_divergence(df, short_window=5, long_window=20):
                                                        df = calc_moving_average(df, short_window)
                                                            df = calc_moving_average(df, long_window)
                                                                signals = []
                                                                    for _, row in df.iterrows():
                                                                                vol_spike = row['成交量'] > row[f'成交量均线_{long_window}日'] * 1.5
                                                                                        price_flat = abs(row['成交均价'] - row[f'成交均价均线_{long_window}日']) < 0.01 * row[f'成交均价均线_{long_window}日']
                                                                                                if vol_spike and price_flat:
                                                                                                                signals.append('量价背离：成交量激增但均价无明显变化，警惕主力异动')
                                                                                                                        else:
                                                                                                                                        signals.append('')
                                                                                                                                            df['量价背离信号'] = signals
                                                                                                                                                return df

                                                                                                                                                def summary_stats(df):
                                                                                                                                                    weekly = resample_period(df, 'W')
                                                                                                                                                        monthly = resample_period(df, 'M')
                                                                                                                                                            return weekly, monthly

# 示例流程
# df = pd.read_csv('your_data.csv')
df = preprocess(df)
df = detect_divergence(df)
weekly_stats, monthly_stats = summary_stats(df)

print(df[['股票代码', '交易日期', '成交量', '成交均价', '量价背离信号']])
print("周度统计：\n", weekly_stats)
print("月度统计：\n", monthly_stats)
```

### 输出样例

| 股票代码 | 交易日期   | 成交量   | 成交均价 | 量价背离信号                              |
|----------|------------|----------|----------|-------------------------------------------|
| 600000   | 2025-07-31 | 123456789| 12.34    | 量价背离：成交量激增但均价无明显变化，警惕主力异动 |

---

## 四、适用场景

- A股量化策略开发
- 资金异动与主力行为监控
- 周期性资金流分析

---
